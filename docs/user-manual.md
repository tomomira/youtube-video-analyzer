# YouTube Video Analyzer ユーザーマニュアル

## 目次

1. [はじめに](#はじめに)
2. [基本的な使い方](#基本的な使い方)
3. [検索条件の設定](#検索条件の設定)
4. [検索結果の操作](#検索結果の操作)
5. [エクスポート機能](#エクスポート機能)
6. [プリセット機能](#プリセット機能)
7. [検索履歴機能](#検索履歴機能)
8. [よくある質問](#よくある質問)

---

## はじめに

YouTube Video Analyzerは、YouTube上の動画を効率的に検索・分析し、結果をExcelやGoogle Spreadsheetsにエクスポートするツールです。

### 主な機能

- ✅ キーワード、再生回数、動画タイプで絞り込み検索
- ✅ 検索結果をテーブル表示（ソート可能）
- ✅ Excelファイル（.xlsx）への出力
- ✅ Google Spreadsheetsへの直接書き込み
- ✅ よく使う検索条件をプリセットとして保存
- ✅ 過去の検索履歴を確認・再実行

---

## 基本的な使い方

### 1. アプリケーションの起動

```bash
# 仮想環境を有効化
source venv/bin/activate  # macOS/Linux
venv\Scripts\activate     # Windows

# アプリを起動
python src/main.py
```

### 2. 最初の検索

1. **検索キーワード**を入力（例: "Python チュートリアル"）
2. **検索**ボタンをクリック
3. 検索中はプログレスバーが表示されます
4. 検索結果がテーブルに表示されます

### 3. 結果の確認

- **タイトル**: 動画のタイトル
- **チャンネル**: チャンネル名
- **再生回数**: カンマ区切りで表示
- **長さ**: HH:MM:SS または MM:SS 形式
- **公開日**: YYYY-MM-DD 形式
- **種類**: 「通常」または「ショート」

### 4. 動画を開く

検索結果の行を**ダブルクリック**すると、ブラウザで動画が開きます。

---

## 検索条件の設定

### キーワード検索

```
例:
- "Python tutorial"
- "料理 レシピ"
- "ゲーム実況"
```

### 再生回数で絞り込み

**最小再生回数**と**最大再生回数**を指定して、人気度で絞り込むことができます。

```
例1: バズった動画を探す
  最小再生回数: 1000000（100万回）
  最大再生回数: （空欄）

例2: 隠れた良動画を探す
  最小再生回数: 1000
  最大再生回数: 10000
```

### 動画タイプ

- **すべて**: ショート動画と通常動画の両方
- **ショート動画**: 60秒以下の動画のみ
- **通常動画**: 60秒を超える動画のみ

### 最大取得件数

検索結果の上限件数を指定します（1〜500件）。

**注意**:
- 多く設定するほどAPIクォータを消費します
- デフォルトは50件（推奨）

### ソート順

- **viewCount**: 再生回数順（人気順）
- **date**: 公開日順（新しい順）
- **rating**: 評価順
- **relevance**: 関連性順（YouTube推奨）
- **title**: タイトル順（アルファベット順）

---

## 検索結果の操作

### ソート機能

テーブルのヘッダー（列名）をクリックすると、その列でソートできます。

- 1回クリック: 昇順
- 2回クリック: 降順

**例**:
- 「再生回数」をクリック → 再生回数の多い順/少ない順
- 「公開日」をクリック → 新しい順/古い順

### スクロール

- **縦スクロール**: マウスホイールまたは縦スクロールバー
- **横スクロール**: Shift+マウスホイールまたは横スクロールバー

### 動画を開く

- 行を**ダブルクリック**するとブラウザで動画が開きます
- URLカラムから直接コピーすることもできます

---

## エクスポート機能

### Excelにエクスポート

#### 方法1: ボタンから

1. 検索を実行して結果を取得
2. 画面右上の**「Excelにエクスポート」**ボタンをクリック
3. 保存先とファイル名を指定
4. 「保存」をクリック

#### 方法2: メニューから

1. メニューバーの**「ファイル」**→**「Excelにエクスポート」**
2. 保存先とファイル名を指定
3. 「保存」をクリック

#### Excelファイルの内容

- **ヘッダー行**: 青色背景、白色太字
- **URL**: クリック可能なハイパーリンク
- **数値**: カンマ区切りで見やすく
- **日付**: YYYY-MM-DD形式
- **カラム幅**: 自動調整

---

### Google Sheetsにエクスポート

#### 事前準備

Google Sheetsエクスポートを使用するには、以下の準備が必要です：

1. **gspreadライブラリのインストール**
   ```bash
   pip install gspread google-auth
   ```

2. **Google Cloud Consoleでサービスアカウントを作成**
   - [Google Cloud Console](https://console.cloud.google.com/)にアクセス
   - 「APIとサービス」→「認証情報」
   - 「認証情報を作成」→「サービスアカウント」
   - サービスアカウントを作成してJSONキーをダウンロード

3. **.envファイルに設定**
   ```bash
   GOOGLE_CREDENTIALS_PATH=credentials.json
   ```

#### エクスポート手順

1. メニューバーの**「ファイル」**→**「Google Sheetsにエクスポート」**
2. スプレッドシート名を入力（例: "YouTube動画リスト"）
3. 「OK」をクリック
4. エクスポート完了後、URLがクリップボードにコピーされます
5. ブラウザでURLを開いてスプレッドシートを確認

#### Google Sheetsの共有

エクスポートしたスプレッドシートを他の人と共有するには：

1. Google Sheetsをブラウザで開く
2. 右上の「共有」ボタンをクリック
3. 共有したい人のメールアドレスを入力
4. 権限を設定（閲覧のみ/編集可）

---

## プリセット機能

よく使う検索条件を保存して、次回から簡単に呼び出すことができます。

### プリセットの保存

1. 検索条件を入力
2. 画面上部の**「保存」**ボタンをクリック
3. プリセット名を入力（例: "初心者向けPython動画"）
4. 「OK」をクリック

### プリセットの読み込み

1. プリセットドロップダウンから保存したプリセットを選択
2. **「読込」**ボタンをクリック
3. 検索条件が自動で入力されます
4. 必要に応じて微調整
5. **「検索」**ボタンをクリック

### プリセットの削除

1. 削除したいプリセットをドロップダウンから選択
2. **「削除」**ボタンをクリック
3. 確認ダイアログで「はい」をクリック

### プリセット活用例

```
プリセット名: "バズったPython動画"
  キーワード: Python tutorial
  最小再生回数: 100000
  動画タイプ: 通常動画
  最大取得件数: 50
  ソート順: viewCount

プリセット名: "最新のReact解説"
  キーワード: React 2024
  動画タイプ: 通常動画
  最大取得件数: 30
  ソート順: date

プリセット名: "料理ショート動画"
  キーワード: 料理
  動画タイプ: ショート動画
  最大取得件数: 100
  ソート順: viewCount
```

---

## 検索履歴機能

過去に実行した検索の履歴を確認し、再検索することができます。

### 検索履歴を開く

メニューバーの**「表示」**→**「検索履歴」**をクリック

### 検索履歴パネルの見方

- **検索日時**: いつ検索したか（YYYY-MM-DD HH:MM:SS形式）
- **キーワード**: 検索キーワード
- **結果件数**: 何件の動画が見つかったか
- **条件**: 再生回数範囲、動画タイプなどの概要

### 履歴から再検索

#### 方法1: ボタンから

1. 再検索したい履歴を選択
2. **「この条件で再検索」**ボタンをクリック
3. 履歴ウィンドウが閉じ、メインウィンドウで検索が実行されます

#### 方法2: ダブルクリック

1. 再検索したい履歴を**ダブルクリック**
2. 即座に検索が実行されます

### 履歴の削除

#### 個別削除

1. 削除したい履歴を選択
2. **「削除」**ボタンをクリック
3. 確認ダイアログで「はい」をクリック

#### 全削除

1. **「すべてクリア」**ボタンをクリック
2. 確認ダイアログで「はい」をクリック
3. すべての検索履歴が削除されます（復元不可）

### 履歴の更新

履歴ウィンドウを開いたままメインウィンドウで検索を実行した場合：

1. **「更新」**ボタンをクリック
2. 最新の履歴が表示されます

---

## よくある質問

### Q1. 検索結果が0件になる

**A**: 以下を確認してください：

1. **キーワードが適切か**
   - スペルミスがないか確認
   - より一般的なキーワードを試す

2. **検索条件が厳しすぎないか**
   - 再生回数の範囲を広げる
   - 動画タイプを「すべて」に変更

3. **APIクォータが残っているか**
   - YouTube Data API v3は1日10,000ユニットまで
   - 翌日になればリセットされます

### Q2. APIクォータとは？

**A**: YouTube Data API v3の利用制限です。

- **デフォルト上限**: 10,000ユニット/日
- **search.list**: 100ユニット/リクエスト
- **videos.list**: 1ユニット/リクエスト

**例**:
- 検索条件で50件取得 = 100ユニット（search.list） + 50ユニット（videos.list） = 150ユニット
- 1日に約66回の検索が可能（150ユニット × 66 = 9,900ユニット）

### Q3. ショート動画と通常動画の違いは？

**A**:
- **ショート動画**: 60秒以下の動画
- **通常動画**: 60秒を超える動画

YouTube APIには公式のショート動画判定がないため、このアプリでは動画の長さで判定しています。

### Q4. 検索結果をCSVで保存したい

**A**: Excelファイルをエクスポート後、Excelで開いて「名前を付けて保存」→「CSV」を選択してください。

### Q5. プリセットや履歴はどこに保存される？

**A**: プロジェクトフォルダの `youtube_analyzer.db`（SQLiteデータベース）に保存されます。

このファイルをバックアップすれば、プリセットと履歴を保持できます。

### Q6. エラーが出た場合は？

**A**: 以下を試してください：

1. **ログファイルを確認**
   ```
   logs/youtube_analyzer.log
   ```

2. **アプリを再起動**

3. **依存パッケージを再インストール**
   ```bash
   pip install --upgrade -r requirements.txt
   ```

4. **問題が解決しない場合**
   - [GitHub Issues](https://github.com/your-repo/issues)で報告
   - エラーメッセージとログファイルの内容を含める

---

## ショートカットキー

現在、キーボードショートカットは実装されていません。将来のバージョンで追加予定です。

---

## データのバックアップ

### バックアップ推奨ファイル

```
youtube_analyzer.db    # プリセットと検索履歴
.env                   # 設定ファイル（APIキー含む）
```

### バックアップ方法

```bash
# 定期的にコピーを作成
cp youtube_analyzer.db youtube_analyzer.db.backup
cp .env .env.backup
```

---

## サポート

### ドキュメント

- [インストールガイド](./installation-guide.md)
- [YouTube API セットアップガイド](./youtube-api-setup-guide.md)
- [開発者向けドキュメント](../CLAUDE.MD)

### 問題報告

[GitHub Issues](https://github.com/your-repo/issues)で報告してください。

---

**最終更新**: 2025年11月26日
**バージョン**: 1.0.0 (Phase 5)
